<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>december adventure 2023 - gb</title>
        <link rel="stylesheet" href="style/style.css">
        <meta name="description" content="">
    </head>
    <body>
        <header>
            <nav>
                <div id="home-link">
                    <a href="/">gb</a>
                </div>
                <div id="navtree"><ul>
	<li><a href=projects.html>projects</a></li>
	<li><a href=explorations.html>explorations</a></li>
	<li><a href=notes.html class="active">notes</a></li>
	<li><a href=about.html>about</a></li>
</ul>
<ul>
	<li><a href=hardware_notes.html>hardware</a></li>
	<li><a href=software_notes.html>software</a></li>
	<li><a href=maths.html>maths</a></li>
	<li><a href=december_adventure_2023.html class="active">december adventure 2023</a></li>
	<li><a href=craft.html>craft</a></li>
	<li><a href=play.html>play</a></li>
</ul>
</div>

            </nav>
        </header>
        <main>
            <section id="main-content">
                
                <article>
                <h1 id="title">december adventure 2023</h1>
                    <p>This year I decided to go on a <a class="outgoing" href="https://eli.li/december-adventure">December Adventure</a>, where I try to work on a project a little bit every day of december.</p>
<p>My goal is to bridge the <em>abstraction gap</em> by learning to write programs in C. As a learning project, I'm building a 3D engine/projector inspired by <a class="outgoing" href="https://wiki.xxiivv.com/site/moogle.html">moogle</a> and <a class="outgoing" href="https://git.sr.ht/~bellinitte/pinhole">pinhole</a> (I technically began working on it in november, but that's what I have going on at the moment so I'll roll with it).</p>
<h1>Log</h1>
<h2>01</h2>
<p><img alt="" src="media/da2023_0112.bmp" /></p>
<p>I already have a few 3D primitives working, so today I added a simple "grid" function which draw a 2D plane. This led me to realize that my program starts lagging severely when the grid is too large.</p>
<h2>02</h2>
<p>Today I learned that the word I had to search for in order to fix my problem was "profiling".</p>
<p>I added a new target with the relevant options to my Makefile, learned about gprof, and discovered that I was recalculating the whole the rotation matrix <em>for every single vertex</em> of the model. As a fix, I used an array to store the matrix values, updated it only once per frame, aaand... I'm still getting performance issues. I'll have to investigate this further tomorrow.</p>
<h2>03</h2>
<p><img alt="" src="media/da2023_0312.jpg" /></p>
<p>As expected, <a class="outgoing" href="https://stackoverflow.com/questions/76861004/memory-leak-in-c-program-using-sdl2">someone on StackOverflow</a> had the same exact problem: turns out the SDL_RenderDrawLine doesn't like it when you tell it to draw extremely long lines. So when an edge ends up between the camera and the focal plane, its projection on the focal plane can become very long. This makes SDL try to allocate more and more memory to draw the entire line, until it can't anymore and crashes.</p>
<p>An easy fix suggested by the top answer was to tell SDL to use another method to to draw lines, which works, but that led me to wanting to learn about line drawing algorithms.
I ended up reimplementing <a class="outgoing" href="https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm">Bresenham's algorithm</a>. So now my program doesn't take up all of the available memory, and I have an array of bytes containing the pixel data that I could export directly as an image.</p>
<h2>04</h2>
<p>Didn't add anything new today, but I did some cleanup and split my code into smaller files. Thus, I learned about header files which, coming from Python, did not make sense to me (why two separate files ?). It works now, but I think I'll still have to play with it to really wrap my head around it.</p>
<p>I still have some cleanup to do for tomorrow, but eventually I'd like to add some other primitives and/or look into reading input files.</p>
                </article>
            </section>
                
        </main>
        <footer>
            <div id="footer-links">
                <a href="https://webring.xxiivv.com/#ghettobastler" target="_blank" rel="noopener">
                    <img class="footer-img" src="webring-logo.svg" alt="XXIIVV webring"/>
                </a>
                <a href="https://github.com/GhettoBastler">
                    <img class="footer-img" src="github-logo.svg" alt="GitHub page">
                </a>
                <a rel="me" href="https://fosstodon.org/@ghettobastler">
                    <img class="footer-img" src="fedi-logo.svg" alt="Mastodon profile">
                </a>
            </div>
            <a id="cc-link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
        </footer>
    </body>
</html>
